---
- name: "install packages for selenium server"
  apt: name={{ item }} state=latest
  with_items:
      - openjdk-7-jdk
      - firefox
      - xvfb
      - fluxbox
      - x11-apps
      - x11vnc
      - xfonts-100dpi
      - xfonts-75dpi
      - xfonts-scalable
      - xfonts-cyrillic

- include: before_install.yml

- name: Download Selenium server (Jar file)
  get_url:
    url: "{{ selenium_download_url }}"
    dest: "{{ selenium_server_path }}/{{ selenium_jar_file }}"
  environment: proxy_env
  sudo: yes

- name: Update owner
  file: path={{ selenium_server_path }}/{{ selenium_jar_file }} owner={{ selenium_user }} group={{ selenium_group }}
  sudo: yes

- name: Create symlink
  file: src={{ selenium_server_path }}/{{ selenium_jar_file }}  dest={{ selenium_server_path }}/{{ selenium_default_name }} state=link owner={{ selenium_user }} group={{ selenium_group }}

- include: services_configuration.yml
